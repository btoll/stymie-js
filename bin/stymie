#!/usr/bin/env node --harmony

(() => {
    'use strict';

    let argv = require('yargs')
            .usage('Usage: stymie <command> [options]')
            .example('stymie add', 'Adds a new entry')
            .command('add', 'Add a new entry')

            .example('stymie edit', 'Edits an entry')
            .command('edit', 'Edit an entry')

            .example('stymie generate', 'Generates a diceware passphrase')
            .command('generate', 'Generate a passphrase')

            .example('stymie get', 'Retrieves an entry')
            .command('get', 'Get an entry')

            .example('stymie has', 'Checks if the entry exists')
            .command('has', 'Check if the entry exists')

            .example('stymie init', 'Installs')
            .command('init', 'Install the password file directory and config file')

            .example('stymie list', 'Lists all entries')
            .command('list', 'List all entries')

            .example('stymie remove', 'Deletes an entry')
            .command('remove', 'Delete an entry')

            .help('h')
            .alias('h', 'help')
            .argv,
        command = argv._[0];

    if (command === 'init') {
        require('../lib/install').install();
    } else {
        try {
            let stymie = require('../index');

            if (command === 'add') {
                stymie.add(argv._[1]);
            } else if (command === 'edit') {
                stymie.edit(argv._[1]);
            } else if (command === 'generate') {
                stymie.generate(argv._[1]);
            } else if (command === 'get') {
                stymie.get(argv._[1]);
            } else if (command === 'has') {
                stymie.has(argv._[1]);
            } else if (command === 'list') {
                stymie.list(argv._[1]);
            } else if (command === 'remove') {
                stymie.remove(argv._[1]);
            }
        } catch (err) {
            // Intentionally left blank.
        }
    }
})();

